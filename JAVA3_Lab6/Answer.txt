// CIS 1C Assignment #6
// Part A

import cs_1c.*;
import java.util.*;

class EBookCompInt implements Comparable<Integer> {
   EBookEntry data;
   public EBookCompInt (EBookEntry e) { 
     data = e; 
   }
   
   public String toString() { 
     return data.toString(); 
   }

   public int compareTo(Integer key) {
      return data.getETextNum() - key;
   }

   public boolean equals( EBookCompInt rhs ) {
      return data.equals(rhs.data);
   }
    
   public int hashCode() {
      return data.getETextNum();
   } 
}

class EBookCompString implements Comparable<String> {
   EBookEntry data;
   public EBookCompString (EBookEntry e) { 
     data = e; 
   }

   public String toString() { 
     return data.toString(); 
   }

   public int compareTo(String key) {
     return data.getCreator().compareTo(key);
   }

   public boolean equals ( EBookCompString rhs ) {
      return data.equals(rhs.data);
   }
    
   public int hashCode() {
      return data.getCreator().hashCode();
   } 
}

//------------------------------------------------------
public class Foothill {

   public static final int NUM_RANDOM_INDICES = 25;
   
   // -------  main --------------
   public static void main(String[] args) throws Exception {
      int k;
      EBookEntryReader book_input = new EBookEntryReader("catalog-short4.txt");
      FHhashQPwFind<String, EBookCompString> hashTableString
         = new FHhashQPwFind<String, EBookCompString>();
      FHhashQPwFind< Integer, EBookCompInt> hashTableInt
         = new FHhashQPwFind<Integer, EBookCompInt>();
      EBookCompString bookResult1;
      EBookCompInt bookResult2;
      
      // test the success of the read
      if (book_input.readError()) {
         System.out.println("couldn't open " + book_input.getFileName()
            + " for input.");
         return;
      }

      // populate both hash tables
      for(k = 0; k < book_input.getNumBooks(); k++) {
         hashTableString.insert(new EBookCompString(book_input.getBook(k)));
         hashTableInt.insert(new EBookCompInt(book_input.getBook(k)));
      }
      
      // attempt to find on the selected string key
      System.out.println( "Attempt to find on the selected string key:\n" );
      for (k = 0; k < NUM_RANDOM_INDICES; k++) {
         String key = book_input.getBook(
            randomIndices(0, book_input.getNumBooks())).getCreator();
         try {
            bookResult1 = hashTableString.Find(key);
            System.out.println(bookResult1.data.toString());
         }
         catch (NoSuchElementException e) {
            System.out.println(String.format("Fail to find book by key %s",key));
         }
         System.out.println();
      }
      
      // attempt to find on the selected integer key
      System.out.println( "Attempt to find on the selected integer key:\n" );
      for (k = 0; k < NUM_RANDOM_INDICES; k++) {
         int key = book_input.getBook(
            randomIndices(0, book_input.getNumBooks())).getETextNum();
         try {
            bookResult2 = hashTableInt.Find(key);
            System.out.println(bookResult2.data.toString());
         }
         catch (NoSuchElementException e) {
            System.out.println(String.format("Fail to find book by key %d",key));
         }
         System.out.println();
      }
      
      // test known successes failures exceptions:
      try {
          bookResult2 = hashTableInt.Find(-3);
      }
      catch (NoSuchElementException e) {
         System.out.println(String.format("Fail to find book by key %d",-3));
      }
      
      // more failures
      try {
         bookResult1 = hashTableString.Find( "Jack Kerouac" );
      }
      catch (NoSuchElementException e) {
          System.out.println(String.format("Fail to find book by key %s",
             "Jack Kerouac"));
      }
   }
   
   static int randomIndices(int min, int max)
   {
      Random rn = new Random();
      int range = max - min + 1;
      int randomNum =  rn.nextInt(range) + min;
      return randomNum;
   }
}

//------------ Class FHhashQPwFind Definition ---------------
import cs_1c.*;
import java.util.*;

public class FHhashQPwFind<KeyType, E extends Comparable<KeyType>>
   extends FHhashQP<E> {

   /**
    * Method to find data by key
    * @param key      target key
    * @return         the object
    */
   public E Find(KeyType key) {
      // find the location
      int pos = findPosKey(key);
      
      // check if the object is deleted
      if (mArray[pos].state != ACTIVE)
         throw new NoSuchElementException();
      
      return mArray[pos].data;
   }
   
   /**
    * Use the key to hash
    * @param key      the key that will be hashed
    * @return         hash result
    */
   protected int myHashKey(KeyType key) {
      int hashVal;

      hashVal = key.hashCode() % mTableSize;
      if(hashVal < 0)
         hashVal += mTableSize;

      return hashVal;
   }
   
   /**
    * Use the key to find the position of object that match the key
    * @param key      target key
    * @return         object position
    */
   protected int findPosKey(KeyType key){
      int kthOddNum = 1;
      int index = myHashKey(key);

      while ( mArray[index].state != EMPTY
         && mArray[index].data.compareTo(key) != 0)
      {
         index += kthOddNum; // k squared = (k-1) squared + kth odd #
         kthOddNum += 2;     // compute next odd #
         if ( index >= mTableSize )
            index -= mTableSize;
      }
      return index;
   }

}
/******************* RUN **********************

Attempt to find on the selected string key:

   # 30026  ---------------
   "A Story of One Short Life, 1783 to 1818"
   by Stryker, Elisabeth G.
   re: Mills, Samuel John, 1783-1818



   # 28334  ---------------
   "The New Hudson Shakespeare: Julius Cæsar"
   by Shakespeare, William, 1564-1616
   re: Tragedies



   # 19012  ---------------
   "The Two-Gun Man"
   by Seltzer, Charles Alden, 1875-1942
   re: (no data found)



   # 27237  ---------------
   "An Essay on the Scriptural Doctrine of Immortality"
   by Challis, James, 1803-1882
   re: Immortality



   # 26063  ---------------
   "A Coin of Edward VIIA Detective Story"
   by Hume, Fergus, 1859-1932
   re: Detective and mystery stories



   # 29767  ---------------
   "The Continental Monthly, Vol. 4, No. 2, August, 1863Devoted to Literature and National Policy"
   by Various
   re: Literature, Modern -- 19th century -- Periodicals



   # 30169  ---------------
   "The Story of the White Mouse"
   by Unknown
   re: Conduct of life -- Juvenile fiction



   # 28792  ---------------
   "Omnilingual"
   by Piper, H. Beam, 1904-1964
   re: Science fiction



   # 24073  ---------------
   "General John Regan"
   by Birmingham, George A., 1865-1950
   re: Ireland -- Fiction



   # 28041  ---------------
   "Selections from the Poems and Plays of Robert Browning"
   by Browning, Robert, 1812-1889
   re: PR



   # 28665  ---------------
   "Sea Garden"
   by H. D. (Hilda Doolittle), 1886-1961
   re: Poetry



   # 27083  ---------------
   "The Subjection of Women"
   by Mill, John Stuart, 1806-1873
   re: Women -- Social and moral questions



   # 29197  ---------------
   "A Short History of Spain"
   by Parmele, Mary Platt, 1843-1911
   re: Spain -- History



   # 25084  ---------------
   "Bell's Cathedrals: The Cathedral Church of RochesterA Description of its Fabric and a Brief History of the Episcopal See"
   by Palmer, G. H. (George Henry), 1871-
   re: Rochester Cathedral (Rochester, Kent, England)



   # 28065  ---------------
   "The Pecan and its Culture"
   by Hume, H. Harold (Hardrada Harold), 1875-1965
   re: Pecan



   # 24303  ---------------
   "The Philadelphia Magazines and their Contributors 1741-1850"
   by Smyth, Albert Henry, 1863-1907
   re: American periodicals -- Pennsylvania -- Philadelphia



   # 26844  ---------------
   "Borneo and the Indian Archipelagowith drawings of costume and scenery"
   by Marryat, Frank, 1826-1855
   re: Malay Archipelago -- Description and travel



   # 26230  ---------------
   "The Picture of Dorian Gray"
   by Wilde, Oscar, 1854-1900
   re: Didactic fiction



   # 22082  ---------------
   "The Emancipation Proclamation"
   by Lincoln, Abraham, 1809-1865
   re: (no data found)



   # 1290  ---------------
   "Salammbo"
   by Flaubert, Gustave, 1821-1880
   re: Fiction



   # 26328  ---------------
   "No. 4, Intercession: A Sermon Preached by the Rev. B. N. Michelson, B.A."
   by Michelson, B. N.
   re: Jewish sermons -- Great Britain



   # 29505  ---------------
   "Suggestions to the Jewsfor improvement in reference to their charities, education,and general government"
   by Faudel, Henry
   re: Jews -- Charities



   # 29601  ---------------
   "See?"
   by Robles, Edward G.
   re: Science fiction



   # 27447  ---------------
   "Mountain BloodA Novel"
   by Hergesheimer, Joseph, 1880-1954
   re: PS



   # 28832  ---------------
   "The Sargasso of Space"
   by Hamilton, Edmond, 1904-1977
   re: Science fiction



Attempt to find on the selected integer key:

   # 29504  ---------------
   "What's He Doing in There?"
   by Leiber, Fritz, 1910-1992
   re: Science fiction



   # 27817  ---------------
   "GyciaA Tragedy in Five Acts"
   by Morris, Lewis, Sir, 1833-1907
   re: Drama



   # 28440  ---------------
   "The Dark Star"
   by Chambers, Robert W. (Robert William), 1865-1933
   re: PS



   # 26623  ---------------
   "The Brass Bellor, The Chariot of Death"
   by Sue, Eugène, 1804-1857
   re: Gaul -- History -- 58 B.C.-511 A.D. -- Fiction



   # 27098  ---------------
   "Technology and Books for All"
   by Lebert, Marie
   re: (no data found)



   # 26524  ---------------
   "The Huguenots in France"
   by Smiles, Samuel, 1812-1904
   re: Huguenots



   # 29009  ---------------
   "Harper's Young People, June 22, 1880An Illustrated Weekly"
   by Various
   re: Children's periodicals, American



   # 14416  ---------------
   "Stories of the Border Marches"
   by Lang, Jeanie
   re: Scottish Borders (Scotland) -- Fiction



   # 28521  ---------------
   "The Power of MesmerismA Highly Erotic Narrative of Voluptuous Facts and Fancies"
   by Anonymous
   re: Erotic stories



   # 27056  ---------------
   "Louis XIV.Makers of History Series"
   by Abbott, John S. C. (John Stevens Cabot), 1805-1877
   re: France -- History -- Louis XIV, 1643-1715



   # 25683  ---------------
   "The Escape of a Princess PatBeing the full account of the capture and fifteen months'imprisonment of Corporal Edwards, of the Princess Patricia'sCanadian Light Infantry, and his final escape from Germanyinto Holland"
   by Pearson, George
   re: World War, 1914-1918 -- Prisoners and prisons, German



   # 29700  ---------------
   "Poetical Works of William Cullen BryantHousehold Edition"
   by Bryant, William Cullen, 1794-1878
   re: Poetry



   # 26437  ---------------
   "The Rubaiyat of a Huffy Husband"
   by Little, Mary Wallace Bundy, 1857-
   re: Omar Khayyam -- Parodies, imitations, etc.



   # 27698  ---------------
   "System der volkswirthschaft. English"
   by Roscher, Wilhelm, 1817-1894
   re: Economics



   # 23904  ---------------
   "The Open Library"
   by Kahle, Brewster, 1960-
   re: (no data found)



   # 22573  ---------------
   "Punch, or the London Charivari, Vol. 146, February 11, 1914"
   by Various
   re: English wit and humor -- Periodicals



   # 4790  ---------------
   "Half a Rogue"
   by MacGrath, Harold, 1871-1932
   re: Fiction



   # 28402  ---------------
   "The Sexual Life of the Child"
   by Moll, Albert, 1862-1939
   re: Sex instruction



   # 26365  ---------------
   "Intestinal IllsChronic Constipation, Indigestion, Autogenetic Poisons, Diarrhea, Piles, Etc. Also Auto-Infection, Auto-Intoxication, Anemia, Emaciation, Etc. Due to Proctitis and Colitis"
   by Jamison, Alcinous B. (Alcinous Burton), 1851-
   re: Intestines -- Diseases



   # 29195  ---------------
   "It's All Yours"
   by Merwin, Sam, 1910-1996
   re: Science fiction



   # 10935  ---------------
   "The Wonderful Adventures of Nils"
   by Lagerlöf, Selma, 1858-1940
   re: (no data found)



   # 27356  ---------------
   "ChelseaThe Fascination of London"
   by Mitton, G. E. (Geraldine Edith)
   re: Chelsea (London, England) -- Description and travel



   # 29307  ---------------
   "North American Medical and Surgical Journal, Vol. 2, No. 3, July, 1826"
   by Various
   re: Medicine -- Periodicals



   # 26040  ---------------
   "Log-book of Timothy BoardmanKept On Board The Privateer Oliver Cromwell, During ACruise From New London, Ct., to Charleston, S. C., AndReturn, In 1778; Also, A Biographical Sketch of The Author."
   by Boardman, Timothy, 1754-1838
   re: Oliver Cromwell (Ship)



   # 28724  ---------------
   "In the High ValleyBeing the fifth and last volume of the Katy Did series"
   by Coolidge, Susan, 1835-1905
   re: PZ



Fail to find book by key -3
Fail to find book by key Jack Kerouac

***********************************************/